package day03_tests

import (
	"github.com/capsocrates/advent-of-code/day03"
	"github.com/stretchr/testify/assert"
	"testing"
)

var (
	exampleInput = []string{
		"..##.......",
		"#...#...#..",
		".#....#..#.",
		"..#.#...#.#",
		".#...##..#.",
		"..#.##.....",
		".#.#.#....#",
		".#........#",
		"#.##...#...",
		"#...##....#",
		".#..#...#.#",
	}

	problemInput = []string{
		".#......##..#.....#....#.#.#...",
		".#.#...#.##.#..........#...##..",
		".........#.....#.####........#.",
		".......#.#...#.#...............",
		"..#....#...#.#...#.#...#.#.....",
		"...#...........#..#.........#.#",
		"....#..#....#..#..#.#...#..##..",
		"#...........#..#.....#.......#.",
		"#..#...#...#.###...#...#.#...#.",
		"#...#.#.......#...#...#...##.##",
		"..#..................#.#.#....#",
		"..#.##....#........##..........",
		".....#....#....#.#.......#.....",
		"##.#..##.#.....###.......#.....",
		"......#...###....#..#.#...#....",
		"..............#.........#.##...",
		"#......#.............#....#...#",
		".#..#......#.###....#...#.....#",
		"..#........#.....#.....#...#..#",
		".......#...#..............#..#.",
		"..#...#........#...##........#.",
		".#........#....#......#......#.",
		"....#..#.###.......##....#.#..#",
		"..#..###..#....................",
		"......#...#....#.........#.#...",
		"....#.##................#..#...",
		"....#......######.....#........",
		".#......##.......#....#..##.###",
		"..#...##.###..#.......#....#...",
		"....#.###...#.#.#........#.....",
		"...###...#.......#..........#.#",
		"..........#...#..........##.#..",
		"..#....#........#.....#....#..#",
		"..#...#.#....##..#...##....#...",
		"........##...#..##.....#.......",
		"###.......#.#...#...#.......#.#",
		"....#.#....##.###........#.....",
		".....#..............#....##..##",
		"#......#.#....#.#......#.....##",
		".....#....#..#......#...#......",
		"..#.##..#.....#..#....#......#.",
		".....#.#.#..........##....#....",
		".........#..#..........#.#.....",
		".##..#...#......#.#..#....#....",
		"#.#..##.......#.#......##......",
		"..#.#....#.#.....#.............",
		".#.........#.......#..#.#......",
		"##.........#..##.#......#......",
		"#..#.....#...#.....#.........#.",
		"..........#..##..##.#..##...###",
		"..##.....#...#..##...##.#.#....",
		"..#..........#.#.....##.#....#.",
		".##..#..#.........###.......#..",
		"......##....#...##....##.......",
		".....#.#.##...............#....",
		"#..#......#.....#..#..#.#.....#",
		".....##.#....#.#.....#.#.#.....",
		"....#..#.#..##....#.....#....#.",
		"#...#.....#....#....#.#.#......",
		".....#................#.......#",
		".......#..#.#...#.#......#..#.#",
		"...........#....#....###...#.#.",
		"#.##....##..###.#.#......#.##.#",
		"..##...#.#..#..#...#.....#.#.#.",
		"#.....###.#..#.#...#.#......#.#",
		"..##.#...#...#.#.....#.#.......",
		"#....#...#.##......#.#......#..",
		"..#.....##.....#...............",
		".....###...##.#...........#....",
		"...#..##.....##....#...........",
		".....#..#......#..........#....",
		"....##..##.#...#...#.#.....#.##",
		".#.....###..###.#...#.#..#....#",
		".#..........#...#..#.#.#..#...#",
		".##.##..#..#....#....####......",
		"....#..#.#..........#..........",
		"###...#.#..#..#...#..###.......",
		"####.#...#....#..#...#..#......",
		".....##....#.#...#....##....##.",
		"....#.#.##....#.##..#....#.#.#.",
		"#......#..#.###....#####.##....",
		"..##..#.#.#..#........##.##..##",
		"#.#...#..#..#......#..#.....#..",
		".###.....#.#....#.#..##.....#.#",
		"....#......#.#...#...#.#....#.#",
		".....#.###.##..................",
		".#..........#........#.#...##.#",
		".##......#.#.#..#....##.###..#.",
		"..#.##....#....#.........#.#..#",
		"........#..#..#.#.####.....##..",
		"#..#.##.#......#.#..##.#...#..#",
		"..#.#.##..#.##..........#......",
		"##.#.....#.#.##..#..##.....##.#",
		".##........#..#.....#...#.##.##",
		"...#....#.#.#.........##.....#.",
		"...#....#.#....#...#..#........",
		".....#...#..#...#.##......##...",
		"##.........#......#..........##",
		".#......#.....##....#.#.#.....#",
		"..#.###......#..#.#....#.....#.",
		".#.......#...#...#.#.#.#..##...",
		"...#..............#...###.....#",
		"...##......#.#..#.#........#.#.",
		"..##.#....#..........##...#.#..",
		"..#...#.....#.######...##...#..",
		"#...#...#............#.....#...",
		".###..###.##..#.........#......",
		".#........##..#....#...#.#..##.",
		"#.#.##.#.#...###...............",
		"..#.#.#......#.#.#....#.....#.#",
		".#...........#.##.#..#.###.....",
		".###.#....#...........##.#.#...",
		".#...#...........#..##.........",
		".#...#.#...........#..###....#.",
		".##.......#.....#.....##....#..",
		"#.......#........#...##.##..#.#",
		"....#..###..#.....##.......#...",
		"......###.#...#..#....#.#...#..",
		"..#..#.......##...#.#.#...#....",
		"......#..#.......#.......##.#..",
		"#.#....###.....#...#..#...#....",
		"#...#.##.#........#..........##",
		".....#.#.##.#.#..#..##.......##",
		".#.#.......##....#.#...........",
		"#..##.............##...#.#..#..",
		"#...........#.#......#.##.##..#",
		"...#...#...........#....###.#.#",
		".##..#.#.#....#....#####.......",
		"..#...#.....#.#....#...........",
		".#..#........#.....#.#......#..",
		".#.........#...#...#.#.#..#....",
		".##.##......#.#...#.......#...#",
		".##...#..#..........#...#.....#",
		"#..........#..#...#.#......#...",
		"....##......#...##..##..#....#.",
		".##.......#...#.#..##..#..#....",
		".#.#................#....#.....",
		"..#..#..###.......#............",
		"...##.....#..#......#....#.....",
		"....#...###...#....#..##...#.#.",
		"#.........#.......#...#....#...",
		".#.#...#.#....##....#.#..##.#..",
		"...#..#..#....#..#.#..##.....##",
		"..#..#.#.#....#...#....#..#....",
		"......###.....#...##.#..#.#...#",
		".#.#.#..#.##........#.#....#...",
		".#..........#....#.#.......#...",
		"#.....#........#........#....#.",
		".#.#..#...#...................#",
		"....####..#..#..#..#....#..#.#.",
		"..##.#..........#.##..#.....##.",
		"..................##..........#",
		"....##....###.....#..#...#.#...",
		".##.........#..#...............",
		"....##..###....#.##............",
		"#.#...###.#..##...#...........#",
		".....#..#......#.....#.........",
		"..#..##...#.....#.....#.#......",
		"......#....###.#..#.#.#....#..#",
		"#...#.......#.##.....#.........",
		".#.#..#...#.............##.....",
		"......#..............#.....#..#",
		"......#......###....#...#......",
		".....#.....#...#.......###.....",
		"#..........##......##.#.#.....#",
		"....#.......#..#......#.......#",
		"..#...#.###...........#..#.###.",
		".....#...#.#...........#.#...##",
		"........#.#.#........#.#.....#.",
		"....##..##.#.#..#.#....#.#.##..",
		"..#.#.#......##.....#...#.#...#",
		"##...#..#......#.#.#..#...#....",
		"....#..##...........#..#..#..#.",
		".#..##...#...#...##.#..#.#....#",
		".#.....####.#..#..#....##..#.#.",
		".#....#..#......#.....#.#.#....",
		"....#..#.....#......#..........",
		"..#.#..###.....#...#...#.....##",
		"..#.#...##..#...........####...",
		".#.##....##.#......#.....##.#..",
		"#.##..#....#.###..........##...",
		".###...#......#.#....##........",
		"...................#..#.....#..",
		"#.#...#.#..#.....#...#..####.##",
		"....#.##..##...##.##.....#.....",
		".#...#.##...........#.......##.",
		"###..#.....##...#.........##...",
		".###....##...###...............",
		".#....#####........#.#.#.##....",
		".#.#....####.##........#.......",
		".....#......#..................",
		"......###.....##......#..##.#..",
		"....#.#...........##.#....##.#.",
		"...................#.#.#.......",
		"#.#.#........#..#.......##.....",
		"..#...#...#....#......#....##.#",
		"#..#..............#......#....#",
		"......#.........##.............",
		".....#.#....##..#.......#......",
		"......#.......#...........#....",
		"....#....#.#..##.#....#...#....",
		"#.#.#..#..#.#.#.#...#....#....#",
		".#.#....#...#.#..#......#.....#",
		".#...........#.#....##.....#...",
		"........#...#....#....##.....##",
		"#..#..........#..#..#.....#....",
		"#.#.###..........#.##....#...##",
		"..#................#.##.##.....",
		"..#...#.##...##...#.........#..",
		"#....#......#......#.........#.",
		"##...#...##.#.........#......#.",
		".......#.....#.................",
		"...#...#.....##.........#.#..#.",
		"..#......#...#.......#......#.#",
		"#.......#...#.##.#..##..#......",
		".#.#............#...###..#.....",
		"...#.......##.......#....#..#..",
		".....#..#.#....#.#.............",
		"#....#...##.##....#....##......",
		"........#......#.......#....#..",
		"..#..#..##......##.#..#.#..##..",
		"....##......#.##.##......#.....",
		"........##.#...#.....#.......#.",
		"..##.#....#..#......#.##.......",
		"..##.####.#...#.#....#.........",
		".#........#.....#..#....#...#.#",
		"###....##......#..#..#.##..#...",
		"..........###.#..#..#....#.....",
		"..#.........#....#.....#....#.#",
		".#...#.#.....##.#...#...#.#..#.",
		"....##......##.##.#.....#..#...",
		"....#.##...##.......#..##......",
		"#..........#..#....#.......#.#.",
		"..#.....#.................#....",
		"..........#.#.#.....#.#....#..#",
		".......#..........#.##....#....",
		"#..#.....#.......#........#....",
		"#.....##..#.........##..#..#.#.",
		".##.#...#..........#....#......",
		"....#..#.#......#.##..#..#.##..",
		"...##.####....#.....#.#...##...",
		"..#.#....#.#........#..........",
		"#...#.#.##.##....##..#...#...#.",
		"...#.#.......#..#...#..#..##..#",
		".....#....#........###.....#...",
		".......#..#.##....#.#.....#....",
		"....##....#....#.......#.....#.",
		".........#........###...##.....",
		"#.#..#...##.........#.#..#....#",
		"...##...........#.........#...#",
		"......#.#.#.........#..#.#.#...",
		"........##.###....#..#.......#.",
		"....#.#...#......#..#........##",
		".#....##....#...#.##.........#.",
		"####.#..#...........##.#.#.....",
		"...#....#..#.....#..##.####.#..",
		".##...#...........#.#.........#",
		"#.#..#..#...#.#.#.........#..#.",
		"#......###............#...#....",
		"..#.......#....#...#...#..#...#",
		"#.#.#...##..#...#...#.......##.",
		"......#.#.......#..........#.#.",
		"...............#...#..#...#.#..",
		".#.#...##.####..##.##....#..##.",
		"#..####.......##.#........#...#",
		"......###....##...#.#..#.##....",
		".##.....###..#...#.###.###.....",
		"..#...#.....#...#..#..##..#....",
		"...#...##.....##........#.#.##.",
		".#...#..#....#....#..###....#.#",
		"..#.#.#.#.#..........#.#..#..##",
		".......###.....................",
		"##.#......#.##.....#.........#.",
		"......................#.#.....#",
		"#..#........##.......#..##..#.#",
		"#.#.#.....##.#.##.##.#....##...",
		".#...#.....#.........#.....#...",
		"..#.........#.##.#.###.#......#",
		".........#..#.##...#.......###.",
		".....##........#......#........",
		"...#.#...##...#........#.##....",
		".........##............#.####..",
		"#....#...#...#..#....#..#.#.#.#",
		"..#.........#......#.##........",
		"....#.....#........#........#.#",
		".##.#..#.#..#..###......###....",
		"#.###.....#.#.#.##........#..##",
		"#.#..#...##.....#....#...#.#...",
		"......#....#.....#...#.........",
		"...#........##.......#.##..####",
		"..#..#....#....#..#..#...#.##..",
		".##.....#............#...#.....",
		"......#.......#.....#...#.#.#..",
		".........#.....#...##..........",
		".....#........##...........#...",
		"#.#..##.#...#....#....#........",
		"#.##..#.#.......#...#......#...",
		"...........#.#..#..#.....##.#..",
		"#....#.##.......#......#.##..#.",
		".....#........#.##.#...#.....#.",
		".....###..#.......##...........",
		".........#.#.#.....#.##.......#",
		".......#....#......#.#.....#...",
		"##........#...#..#.#.........#.",
		"##...........#.##...##......#..",
		"..#.###.#.#.#...####..#....###.",
		".........#...#.....##....#.#.##",
		".###..###.#.#.....#.##.........",
		"#..#...#.#.................##.#",
		"##.........#.#....#.#...#.###..",
		"#.#....#..............#.##.#...",
		"...#..#....##.#..#.......#..##.",
		".#..#.###......##..........#..#",
		".##....#.#....#....#.#..#......",
		".......#.....#..#....#.##...#..",
		"#.#.#.........###..#..#.....#..",
		"...##..##...##....#..#......#..",
		"..........#....#..........#....",
		"#..##..#...#......#.....#.#....",
		"#..##..#....#.#.#...#..........",
		"......##..#.........#........#.",
		".##..#..#......###.....#..#....",
		".....#..#.##..........#.#..#...",
	}
)

func TestCountTreesPart1ExampleDay03(t *testing.T) {
	count := day03.CountTreesPart1(exampleInput)

	assert.Equal(t, 7, count)
}

func BenchmarkCountTreesPart1ExampleDay03(b *testing.B) {
	for i := 0; i <= b.N; i++ {
		day03.CountTreesPart1(exampleInput)
	}
}

func TestCountTreesPart1Day03(t *testing.T) {
	count := day03.CountTreesPart1(problemInput)

	assert.Equal(t, 200, count)
}

func BenchmarkCountTreesPart1Day03(b *testing.B) {
	for i := 0; i <= b.N; i++ {
		day03.CountTreesPart1(problemInput)
	}
}

func TestTotalTreesPart2ExampleDay03(t *testing.T) {
	one, two, three, four, five := day03.TotalTreesPart2(exampleInput)

	assert.Equal(t, 2, one)
	assert.Equal(t, 7, two)
	assert.Equal(t, 3, three)
	assert.Equal(t, 4, four)
	assert.Equal(t, 2, five)

	assert.Equal(t, 336, one*two*three*four*five)
}

func BenchmarkTotalTreesPart2ExampleDay03(b *testing.B) {
	for i := 0; i <= b.N; i++ {
		day03.TotalTreesPart2(exampleInput)
	}
}

func TestTotalTreesPart2Day03(t *testing.T) {
	one, two, three, four, five := day03.TotalTreesPart2(problemInput)

	assert.Equal(t, 66, one)
	assert.Equal(t, 200, two)
	assert.Equal(t, 76, three)
	assert.Equal(t, 81, four)
	assert.Equal(t, 46, five)

	assert.Equal(t, 3737923200, one*two*three*four*five)
}

func BenchmarkTotalTreesPart2Day03(b *testing.B) {
	for i := 0; i <= b.N; i++ {
		day03.TotalTreesPart2(problemInput)
	}
}

func TestBadInputDay03(t *testing.T) {
	t.Run("EmptyRow", func(t *testing.T) {
		count := day03.CountTreesPart1([]string{""})

		assert.Equal(t, -1, count)
	})
	t.Run("EmptySet", func(t *testing.T) {
		count := day03.CountTreesPart1([]string{})

		assert.Equal(t, -1, count)
	})
}
